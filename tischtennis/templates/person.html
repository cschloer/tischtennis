<!DOCTYPE html>
{{ define "head" }}
  <script src="{{.BasePath}}/static/js/person.js"></script>
{{ end }}
{{ define "body" }}
<div class="container mt-5">
  <div class="columns">
    <div class="column mx-2">
        
      <a href="{{.BasePath}}/" class="mb-2">
        <figure class="image mx-6 is-4by3">
          <img src="https://drive.google.com/uc?export=view&id=1e8yxR_I01wzxfhcolG3aPMTbEmyqKIl0" />
        </figure>
      </a>
      <div class="notification is-danger general-error-line margin-top-1" style="display: none;"></div>
      <div class="block box">
        <h2 class="has-text-black has-text-weight-medium is-size-2 has-text-centered">{{ .Person.Name }}</h2>
        <h4 class="has-text-info is-size-4 has-text-centered">
          <span class="has-text-grey">Score: </span>
          {{ if (eq .Person.Score -1.0) }} n/a - play a game! {{ else }}{{ mul .Person.Score 1000.0 }}{{ end }}
        </h2>
        <h4 class="is-size-4 has-text-centered">
          <span class="has-text-grey">Record: </span>
          <span class="has-text-success">{{ .Person.Wins }}</span> - 
          <span class="has-text-danger">{{ .Person.Losses }}</span>
        </h2>
      </div>
    </div>
    <div class="column">
      <div class="block">
        <h4 class="has-text-black has-text-weight-medium is-size-4 has-text-centered">Previously Reported Games</h4>
      </div>
      <div class="block px-3">
        <table class="table mx-auto">
          <thead>
            <tr>
              <th>Against</th>
              <th>Wins</th>
              <th>Losses</th>
              <th>Reported By</th>
            </tr>
          </thead>
          <tbody>
            {{ range .Games }}
              <tr>
                <td>
                  {{index $.PersonIdToNameMap .OtherPersonId}}
                </td>

                {{ if gt .Wins .Losses }}
                  <td class="has-text-success">{{.Wins}}</td>
                {{ else }}
                  {{ if gt .Losses .Wins }}
                    <td class="has-text-danger">{{.Wins}}</td>
                  {{ else }}
                    <td>{{.Wins}}</td>
                  {{ end }}
                {{ end }}

                <td>{{.Losses}}</td>

                <td class="has-text-grey">
                  {{ if .Reporter }} {{$.Person.Name}}
                  {{ else }} {{index $.PersonIdToNameMap .OtherPersonId}}
                  {{ end }}
                </td>
              </tr>
            {{ end }}
          </tbody>
        </table>
      </div>

    </div>
    <div class="column mx-2">
      <div class="block">
        <div class="box report-game-box">
          <div class="notification is-danger error-line margin-top-1" style="display: none;"></div>
          <h4 class="has-text-black has-text-weight-medium is-size-4 has-text-centered mb-2">
            <span class="icon mr-1">
              <i class="fas fa-table-tennis"></i>
            </span>
            Report a new game
          </h2>

          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Against</label>
            </div>
            <div class="field-body">
              <div class="field">
                <div class="control has-icons-left">
                  <div class="select w-100">
                    <select class="w-100" name="other_person">
                      <option value="">Select an opponent</option>
                      {{ range .AlphSortedPeople }}
                        {{ if ne .Id $.Person.Id }}
                        <option value="{{ .Id }}">{{ .Name }}</option>
                        {{ end }}
                      {{ end }}
                    </select>
                  </div>
                  <div class="icon is-small is-left">
                    <i class="fas fa-user"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Wins</label>
            </div>
            <div class="field-body">
              <div class="field">
                <p class="control has-icons-left">
                  <input class="input" type="number" name="wins" placeholder="Wins" value="0">
                  <span class="icon is-left has-text-success">
                    <i class="fas fa-smile-beam"></i>
                  </span>
                </p>
              </div>
            </div>
          </div>
          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Losses</label>
            </div>
            <div class="field-body">
              <div class="field">
                <p class="control has-icons-left">
                  <input class="input" type="number" name="losses" placeholder="Losses" value="0">
                  <span class="icon is-left has-text-danger">
                    <i class="fas fa-sad-cry"></i>
                  </span>
                </p>
              </div>
            </div>
          </div>
          <hr />
          <div class="field">
            <p class="control has-icons-left">
              <input class="input" type="password" name="person_access_key" placeholder="Your Access Key">
              <span class="icon is-left">
                <i class="fas fa-lock"></i>
              </span>
            </p>
          </div>
          <div class="field">
            <p class="control has-text-centered">
              <button class="button is-success w-100">
                Submit 
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
</div>

  <script>
    setup("{{ .Person.Id }}");
  </script>

{{ end }}
